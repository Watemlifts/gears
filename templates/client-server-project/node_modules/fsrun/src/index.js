"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var sys_1 = require("./sys/sys");
var parse_1 = require("./parser/parse");
var writer_1 = require("./writer/writer");
var runtime_1 = require("./runtime/runtime");
(function () {
    var writer = writer_1.create_writer(process.stdout);
    try {
        var argument = parse_1.parse_argument(process.argv);
        argument.paths = argument.paths.map(function (path) { return sys_1.resolve_path(path); });
        argument.paths.forEach(function (path) {
            if (sys_1.path_exists(path) === false)
                throw Error("no such file or directory.");
        });
        if (argument.commands.length === 0)
            throw Error("nothing to run.");
        argument.paths.forEach(function (path) { return writer.info("[watching: " + path + "]"); });
        var runtime = runtime_1.create_runtime(argument, writer);
        runtime.start();
    }
    catch (e) {
        writer.write(e.message + "\n");
    }
})();
